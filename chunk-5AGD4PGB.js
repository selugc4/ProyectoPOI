import{a as B}from"./chunk-UYLNLCYZ.js";import{c as r,g as v,i as f,oa as a,pa as b,qa as R}from"./chunk-BWDMBPI3.js";import{g as u}from"./chunk-OLRFWS6T.js";var C=(()=>{let p=class p{constructor(){this.baseUrl="https://twm-a0gahqe6exa7fxh6.westeurope-01.azurewebsites.net/locations/",this.http=f(R),this.authService=f(B)}getAllLocations(){return this.http.get(this.baseUrl)}searchLocations(t){let e=new b;return t.name&&(e=e.set("name",t.name)),t.date&&(e=e.set("date",t.date)),t.region&&(e=e.set("region",t.region)),this.http.get(this.baseUrl,{params:e})}getLocationById(t){return this.http.get(`${this.baseUrl}${t}`)}addReview(t,e){let o=`${this.baseUrl}${t}/reviews`;return this.http.post(o,e)}addReviewLogged(t,e){let o=`${this.baseUrl}${t}/reviews`;return this.http.post(o,e)}deleteReview(t,e){return u(this,null,function*(){let o=yield this.authService.getFirebaseIdToken();if(!o)throw new Error("No se pudo obtener el token de Firebase");let h="https://twm-a0gahqe6exa7fxh6.westeurope-01.azurewebsites.net/login",c=new a({"Content-Type":"application/json"}),w={firebaseToken:o},s=(yield r(this.http.post(h,w,{headers:c}))).token;if(!s)throw new Error("No se recibi\xF3 token personalizado");let i=`${this.baseUrl}${t}/reviews/${e}`,l=new a().set("Authorization",`Bearer ${s}`);return yield r(this.http.delete(i,{headers:l}))})}updateLocation(t,e){return u(this,null,function*(){let o=yield this.authService.getFirebaseIdToken();if(!o)throw new Error("No se pudo obtener el token de Firebase");let h="https://twm-a0gahqe6exa7fxh6.westeurope-01.azurewebsites.net/login",c=new a({"Content-Type":"application/json"}),w={firebaseToken:o},s=(yield r(this.http.post(h,w,{headers:c}))).token;if(!s)throw new Error("No se recibi\xF3 token personalizado");let i=`${this.baseUrl}${e}`,l=s?new a().set("Authorization",`Bearer ${s}`):void 0;return yield r(this.http.put(i,t,{headers:l}))})}deleteLocation(t){return u(this,null,function*(){let e=yield this.authService.getFirebaseIdToken();if(!e)throw new Error("No se pudo obtener el token de Firebase");let o="https://twm-a0gahqe6exa7fxh6.westeurope-01.azurewebsites.net/login",h=new a({"Content-Type":"application/json"}),c={firebaseToken:e},n=(yield r(this.http.post(o,c,{headers:h}))).token;if(!n)throw new Error("No se recibi\xF3 token personalizado");let s=`${this.baseUrl}${t}`,i=n?new a().set("Authorization",`Bearer ${n}`):void 0;return yield r(this.http.delete(s,{headers:i}))})}getApiPOIs(t,e,o){return u(this,null,function*(){let h=yield this.authService.getFirebaseIdToken();if(!h)throw new Error("No se pudo obtener el token de Firebase");let c="https://twm-a0gahqe6exa7fxh6.westeurope-01.azurewebsites.net/login",w=new a({"Content-Type":"application/json"}),n={firebaseToken:h},i=(yield r(this.http.post(c,n,{headers:w}))).token;if(!i)throw new Error("No se recibi\xF3 token personalizado");let l=new b;t&&(l=l.set("name",t)),e!==void 0&&(l=l.set("lat",e.toString())),o!==void 0&&(l=l.set("lng",o.toString()));let F="https://twm-a0gahqe6exa7fxh6.westeurope-01.azurewebsites.net/locationsApi",E=i?new a().set("Authorization",`Bearer ${i}`):void 0;return(yield r(this.http.get(F,{headers:E,params:l}))).map(d=>{var m,k,y,$,z,T,U,x;return{name:d.name,address:((m=d.location)==null?void 0:m.address)||"",locality:((k=d.location)==null?void 0:k.locality)||"",region:((y=d.location)==null?void 0:y.region)||"",country:(($=d.location)==null?void 0:$.country)||"",fsq_id:d.fsq_id,image:"",Otherlat:((z=d.geocodes)==null?void 0:z.main.latitude)||0,Otherlng:((T=d.geocodes)==null?void 0:T.main.longitude)||0,Ownlat:((U=d.geocodes)==null?void 0:U.main.latitude)||0,Ownlng:((x=d.geocodes)==null?void 0:x.main.longitude)||0,reviews:[],createdBy:""}})})}insertMany(t){return u(this,null,function*(){let e=yield this.authService.getFirebaseIdToken();if(!e)throw new Error("No se pudo obtener el token de Firebase");let o="https://twm-a0gahqe6exa7fxh6.westeurope-01.azurewebsites.net/login",h=new a({"Content-Type":"application/json"}),c={firebaseToken:e},n=(yield r(this.http.post(o,c,{headers:h}))).token;if(!n)throw new Error("No se recibi\xF3 token personalizado");let s=`${this.baseUrl}many`,i=n?new a().set("Authorization",`Bearer ${n}`):void 0;return yield r(this.http.post(s,t,{headers:i}))})}insert(t){return u(this,null,function*(){let e=yield this.authService.getFirebaseIdToken();if(!e)throw new Error("No se pudo obtener el token de Firebase");let o="https://twm-a0gahqe6exa7fxh6.westeurope-01.azurewebsites.net/login",h=new a({"Content-Type":"application/json"}),c={firebaseToken:e},n=(yield r(this.http.post(o,c,{headers:h}))).token;if(!n)throw new Error("No se recibi\xF3 token personalizado");let s=`${this.baseUrl}`,i=n?new a().set("Authorization",`Bearer ${n}`):void 0;return yield r(this.http.post(s,t,{headers:i}))})}};p.\u0275fac=function(e){return new(e||p)},p.\u0275prov=v({token:p,factory:p.\u0275fac,providedIn:"root"});let g=p;return g})();export{C as a};
