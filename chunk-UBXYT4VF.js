import{a as B}from"./chunk-OMEQORPI.js";import{c as i,g as R,i as b,pa as h,qa as g,ra as v}from"./chunk-M5FVIQMQ.js";import{g as u}from"./chunk-OLRFWS6T.js";var C=(()=>{let d=class d{constructor(){this.baseUrl="https://twm-a0gahqe6exa7fxh6.westeurope-01.azurewebsites.net/locations/",this.http=b(v),this.authService=b(B)}getAllLocations(){return this.http.get(this.baseUrl)}searchLocations(t){let e=new g;return t.name&&(e=e.set("name",t.name)),t.date&&(e=e.set("date",t.date)),t.region&&(e=e.set("region",t.region)),this.http.get(this.baseUrl,{params:e})}getLocationById(t){return this.http.get(`${this.baseUrl}${t}`)}addReview(t,e){let o=`${this.baseUrl}${t}/reviews`;return this.http.post(o,e)}addReviewLogged(t,e){let o=`${this.baseUrl}${t}/reviews`;return this.http.post(o,e)}deleteReview(t,e){return u(this,null,function*(){let o=yield this.authService.getFirebaseIdToken();if(!o)throw new Error("No se pudo obtener el token de Firebase");let n="https://twm-a0gahqe6exa7fxh6.westeurope-01.azurewebsites.net/login",c=new h({"Content-Type":"application/json"}),p={firebaseToken:o},r=(yield i(this.http.post(n,p,{headers:c}))).token;if(!r)throw new Error("No se recibi\xF3 token personalizado");let a=`${this.baseUrl}${t}/reviews/${e}`,l=new h().set("Authorization",`Bearer ${r}`);return yield i(this.http.delete(a,{headers:l}))})}updateLocation(t,e){return u(this,null,function*(){let o=yield this.authService.getFirebaseIdToken();if(!o)throw new Error("No se pudo obtener el token de Firebase");let n="https://twm-a0gahqe6exa7fxh6.westeurope-01.azurewebsites.net/login",c=new h({"Content-Type":"application/json"}),p={firebaseToken:o},r=(yield i(this.http.post(n,p,{headers:c}))).token;if(!r)throw new Error("No se recibi\xF3 token personalizado");let a=`${this.baseUrl}${e}`,l=r?new h().set("Authorization",`Bearer ${r}`):void 0;return yield i(this.http.put(a,t,{headers:l}))})}deleteLocation(t){return u(this,null,function*(){let e=yield this.authService.getFirebaseIdToken();if(!e)throw new Error("No se pudo obtener el token de Firebase");let o="https://twm-a0gahqe6exa7fxh6.westeurope-01.azurewebsites.net/login",n=new h({"Content-Type":"application/json"}),c={firebaseToken:e},s=(yield i(this.http.post(o,c,{headers:n}))).token;if(!s)throw new Error("No se recibi\xF3 token personalizado");let r=`${this.baseUrl}${t}`,a=s?new h().set("Authorization",`Bearer ${s}`):void 0;return yield i(this.http.delete(r,{headers:a}))})}getApiPOIs(t,e,o){return u(this,null,function*(){let n=yield this.authService.getFirebaseIdToken();if(!n)throw new Error("No se pudo obtener el token de Firebase");let c="https://twm-a0gahqe6exa7fxh6.westeurope-01.azurewebsites.net/login",p=new h({"Content-Type":"application/json"}),s={firebaseToken:n},a=(yield i(this.http.post(c,s,{headers:p}))).token;if(!a)throw new Error("No se recibi\xF3 token personalizado");let l=new g;t&&(l=l.set("name",t)),e!==void 0&&(l=l.set("lat",e.toString())),o!==void 0&&(l=l.set("lng",o.toString()));let F="https://twm-a0gahqe6exa7fxh6.westeurope-01.azurewebsites.net/locationsApi",q=a?new h().set("Authorization",`Bearer ${a}`):void 0;return(yield i(this.http.get(F,{headers:q,params:l}))).map(w=>{var m,k,y,z,x,$,T,U;return{name:w.name,address:((m=w.location)==null?void 0:m.address)||"",locality:((k=w.location)==null?void 0:k.locality)||"",region:((y=w.location)==null?void 0:y.region)||"",country:((z=w.location)==null?void 0:z.country)||"",fsq_id:w.fsq_id,image:"",Otherlat:((x=w.geocodes)==null?void 0:x.main.latitude)||0,Otherlng:(($=w.geocodes)==null?void 0:$.main.longitude)||0,Ownlat:((T=w.geocodes)==null?void 0:T.main.latitude)||0,Ownlng:((U=w.geocodes)==null?void 0:U.main.longitude)||0,reviews:[],createdBy:""}})})}insertMany(t){return u(this,null,function*(){let e=yield this.authService.getFirebaseIdToken();if(!e)throw new Error("No se pudo obtener el token de Firebase");let o="https://twm-a0gahqe6exa7fxh6.westeurope-01.azurewebsites.net/login",n=new h({"Content-Type":"application/json"}),c={firebaseToken:e},s=(yield i(this.http.post(o,c,{headers:n}))).token;if(!s)throw new Error("No se recibi\xF3 token personalizado");let r=`${this.baseUrl}many`,a=s?new h().set("Authorization",`Bearer ${s}`):void 0;return yield i(this.http.post(r,t,{headers:a}))})}insert(t){return u(this,null,function*(){let e=yield this.authService.getFirebaseIdToken();if(!e)throw new Error("No se pudo obtener el token de Firebase");let o="https://twm-a0gahqe6exa7fxh6.westeurope-01.azurewebsites.net/login",n=new h({"Content-Type":"application/json"}),c={firebaseToken:e},s=(yield i(this.http.post(o,c,{headers:n}))).token;if(!s)throw new Error("No se recibi\xF3 token personalizado");let r=`${this.baseUrl}`,a=s?new h().set("Authorization",`Bearer ${s}`):void 0;return yield i(this.http.post(r,t,{headers:a}))})}getRecommendedRoute(t,e){let o=new g().set("userId",e).set("city",t),n=this.http.get("https://twm-a0gahqe6exa7fxh6.westeurope-01.azurewebsites.net/locationsGroq",{params:o});return i(this.http.post("https://twm-a0gahqe6exa7fxh6.westeurope-01.azurewebsites.net/ruta",{city:t,locations:n}))}};d.\u0275fac=function(e){return new(e||d)},d.\u0275prov=R({token:d,factory:d.\u0275fac,providedIn:"root"});let f=d;return f})();export{C as a};
