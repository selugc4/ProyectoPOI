import{a as B}from"./chunk-UYLNLCYZ.js";import{c as a,g as T,i as f,oa as h,pa as b,qa as R}from"./chunk-BWDMBPI3.js";import{g as u}from"./chunk-OLRFWS6T.js";var C=(()=>{let w=class w{constructor(){this.baseUrl="https://twm-a0gahqe6exa7fxh6.westeurope-01.azurewebsites.net/locations/",this.http=f(R),this.authService=f(B)}getAllLocations(){return this.http.get(this.baseUrl)}searchLocations(t){let e=new b;return t.name&&(e=e.set("name",t.name)),t.date&&(e=e.set("date",t.date)),t.region&&(e=e.set("region",t.region)),this.http.get(this.baseUrl,{params:e})}getLocationById(t){return this.http.get(`${this.baseUrl}${t}`)}addReview(t,e){let o=`${this.baseUrl}${t}/reviews`;return this.http.post(o,e)}addReviewLogged(t,e){let o=`${this.baseUrl}${t}/reviews`;return this.http.post(o,e)}deleteReview(t,e){return u(this,null,function*(){let o=yield this.authService.getFirebaseIdToken();if(!o)throw new Error("No se pudo obtener el token de Firebase");let c="https://twm-a0gahqe6exa7fxh6.westeurope-01.azurewebsites.net/login",d=new h({"Content-Type":"application/json"}),p={firebaseToken:o},s=(yield a(this.http.post(c,p,{headers:d}))).token;if(!s)throw new Error("No se recibi\xF3 token personalizado");let i=`${this.baseUrl}${t}/reviews/${e}`,r=new h().set("Authorization",`Bearer ${s}`);return yield a(this.http.delete(i,{headers:r}))})}updateLocation(t,e){return u(this,null,function*(){let o=yield this.authService.getFirebaseIdToken();if(!o)throw new Error("No se pudo obtener el token de Firebase");let c="https://twm-a0gahqe6exa7fxh6.westeurope-01.azurewebsites.net/login",d=new h({"Content-Type":"application/json"}),p={firebaseToken:o},s=(yield a(this.http.post(c,p,{headers:d}))).token;if(!s)throw new Error("No se recibi\xF3 token personalizado");let i=`${this.baseUrl}${e}`,r=s?new h().set("Authorization",`Bearer ${s}`):void 0;return yield a(this.http.put(i,t,{headers:r}))})}deleteLocation(t){return u(this,null,function*(){let e=yield this.authService.getFirebaseIdToken();if(!e)throw new Error("No se pudo obtener el token de Firebase");let o="https://twm-a0gahqe6exa7fxh6.westeurope-01.azurewebsites.net/login",c=new h({"Content-Type":"application/json"}),d={firebaseToken:e},n=(yield a(this.http.post(o,d,{headers:c}))).token;if(!n)throw new Error("No se recibi\xF3 token personalizado");let s=`${this.baseUrl}${t}`,i=n?new h().set("Authorization",`Bearer ${n}`):void 0;return yield a(this.http.delete(s,{headers:i}))})}getApiPOIs(t,e,o){return u(this,null,function*(){let c=yield this.authService.getFirebaseIdToken();if(!c)throw new Error("No se pudo obtener el token de Firebase");let d="https://twm-a0gahqe6exa7fxh6.westeurope-01.azurewebsites.net/login",p=new h({"Content-Type":"application/json"}),n={firebaseToken:c},i=(yield a(this.http.post(d,n,{headers:p}))).token;if(!i)throw new Error("No se recibi\xF3 token personalizado");let r=new b;t&&(r=r.set("name",t)),e!==void 0&&(r=r.set("lat",e.toString())),o!==void 0&&(r=r.set("lng",o.toString()));let F="https://twm-a0gahqe6exa7fxh6.westeurope-01.azurewebsites.net/locationsApi",E=i?new h().set("Authorization",`Bearer ${i}`):void 0;return(yield a(this.http.get(F,{headers:E,params:r}))).map(l=>{var m,k,y,$,z,U,v,x;return{name:l.name,address:((m=l.location)==null?void 0:m.address)||"",locality:((k=l.location)==null?void 0:k.locality)||"",region:((y=l.location)==null?void 0:y.region)||"",country:(($=l.location)==null?void 0:$.country)||"",fsq_id:l.fsq_id,image:"",Otherlat:((z=l.geocodes)==null?void 0:z.main.latitude)||0,Otherlng:((U=l.geocodes)==null?void 0:U.main.longitude)||0,Ownlat:((v=l.geocodes)==null?void 0:v.main.latitude)||0,Ownlng:((x=l.geocodes)==null?void 0:x.main.longitude)||0,reviews:[],createdBy:""}})})}insertMany(t){return u(this,null,function*(){let e=yield this.authService.getFirebaseIdToken();if(!e)throw new Error("No se pudo obtener el token de Firebase");let o="https://twm-a0gahqe6exa7fxh6.westeurope-01.azurewebsites.net/login",c=new h({"Content-Type":"application/json"}),d={firebaseToken:e},n=(yield a(this.http.post(o,d,{headers:c}))).token;if(!n)throw new Error("No se recibi\xF3 token personalizado");let s=`${this.baseUrl}many`,i=n?new h().set("Authorization",`Bearer ${n}`):void 0;return yield a(this.http.post(s,t,{headers:i}))})}};w.\u0275fac=function(e){return new(e||w)},w.\u0275prov=T({token:w,factory:w.\u0275fac,providedIn:"root"});let g=w;return g})();export{C as a};
