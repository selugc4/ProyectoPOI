import{a as Z}from"./chunk-SJ65IWPI.js";import"./chunk-Z6QA5H52.js";import{$ as f,Aa as W,Da as z,E as v,F as w,G as u,H as n,I as t,Ia as N,J as k,N as O,O as M,P as C,Pa as B,X as r,Y as p,_ as h,aa as _,e as b,gb as R,hb as V,i as x,ja as T,kb as Y,l as y,lb as j,m as S,ma as D,mb as q,nb as A,ob as G,pb as H,qb as U,s as E,sa as F,t as o,tb as J,va as L,w as I,xb as K,yb as Q,z as P,zb as X}from"./chunk-EJZ5YJM5.js";import"./chunk-UDHHHPKJ.js";import"./chunk-JSQDAY7T.js";import"./chunk-PAAW3VWM.js";import"./chunk-VU72VQEI.js";import"./chunk-BU6F7OWR.js";import"./chunk-JZYWOUJL.js";import"./chunk-WHJRDKSF.js";import"./chunk-4U6PRYVA.js";import"./chunk-LB2OG3QI.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import"./chunk-OLRFWS6T.js";var $=(l,a)=>a._id;function ee(l,a){if(l&1&&(n(0,"ion-text",10)(1,"p"),r(2),t()()),l&2){let c=C();o(2),p(c.errorMessage)}}function te(l,a){if(l&1){let c=O();n(0,"ion-col",9)(1,"ion-card",11),M("click",function(){let s=y(c).$implicit,e=C();return S(e.openLocationDetail(s._id))}),n(2,"ion-row")(3,"ion-col",12),k(4,"img",13)(5,"img"),t(),n(6,"ion-col",14)(7,"ion-card-title"),r(8),t(),n(9,"p",15),r(10),t(),n(11,"p",16),r(12),t(),n(13,"p",17),r(14),t()()()()()}if(l&2){let c=a.$implicit;o(4),u("src",c.image||"assets/LocationDefault.png",E),o(4),p(c.name),o(2),p(c.address||"Direcci\xF3n no disponible"),o(2),p(c.locality),o(2),p(c.country)}}var pe=(()=>{let a=class a{constructor(){this.name="",this.date="",this.region="",this.locations=[],this.locationsService=x(Z),this.errorMessage="",this.router=x(L)}ngOnInit(){this.router.events.pipe(b(d=>d instanceof F)).subscribe(d=>{d.url.startsWith("/search")||this.resetFields()})}search(){var s,e,m,i;if([(s=this.name)==null?void 0:s.trim(),(m=(e=this.date)==null?void 0:e.trim)==null?void 0:m.call(e),(i=this.region)==null?void 0:i.trim()].filter(g=>g).length>1){this.errorMessage="Por favor, busca solo por uno de estos par\xE1metros a la vez: nombre, fecha o regi\xF3n.",this.locations=[];return}this.errorMessage="",this.locationsService.searchLocations({name:this.name||void 0,date:this.date||void 0,region:this.region||void 0}).subscribe({next:g=>{this.locations=g,g.length===0&&(this.errorMessage="No se encontraron resultados.")},error:g=>{g.status===404?this.errorMessage="Error al buscar: No se puede encontrar el POI con el par\xE1metro proporcionado":this.errorMessage="Error al buscar: La base de datos no est\xE1 disponible"}})}openLocationDetail(d){this.router.navigate(["/location-detail",d])}resetFields(){this.name="",this.date="",this.region="",this.locations=[],this.errorMessage=""}};a.\u0275fac=function(s){return new(s||a)},a.\u0275cmp=I({type:a,selectors:[["app-search"]],decls:29,vars:6,consts:[[3,"translucent"],[3,"fullscreen"],[1,"search-container"],["position","stacked"],["type","text","name","name","ngDefaultControl","",3,"ngModelChange","ngModel"],["type","date","name","date","ngDefaultControl","",3,"ngModelChange","ngModel"],["type","text","name","region","ngDefaultControl","",3,"ngModelChange","ngModel"],["expand","block",3,"click"],["color","danger",4,"ngIf"],["size","6"],["color","danger"],[1,"location-card",3,"click"],["size","5"],[1,"location-image",3,"src"],["size","7",1,"location-details"],[1,"address"],[1,"locality"],[1,"country"]],template:function(s,e){s&1&&(n(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),r(3,"search"),t()()(),n(4,"ion-content",1)(5,"div",2)(6,"h3")(7,"strong"),r(8,"Busca unos POI concretos"),t(),r(9,", recuerda que solo puedes realizar la b\xFAsqueda sin par\xE1metros o con uno de los tres par\xE1metros"),t(),n(10,"ion-item")(11,"ion-label",3),r(12,"Nombre"),t(),n(13,"ion-input",4),_("ngModelChange",function(i){return f(e.name,i)||(e.name=i),i}),t()(),n(14,"ion-item")(15,"ion-label",3),r(16,"Fecha (YYYY-MM-DD)"),t(),n(17,"ion-input",5),_("ngModelChange",function(i){return f(e.date,i)||(e.date=i),i}),t()(),n(18,"ion-item")(19,"ion-label",3),r(20,"Regi\xF3n"),t(),n(21,"ion-input",6),_("ngModelChange",function(i){return f(e.region,i)||(e.region=i),i}),t()(),n(22,"ion-button",7),M("click",function(){return e.search()}),r(23,"Buscar"),t(),P(24,ee,3,1,"ion-text",8),t(),n(25,"ion-grid")(26,"ion-row"),v(27,te,15,5,"ion-col",9,$),t()()()),s&2&&(u("translucent",!0),o(4),u("fullscreen",!0),o(9),h("ngModel",e.name),o(4),h("ngModel",e.date),o(4),h("ngModel",e.region),o(3),u("ngIf",e.errorMessage),o(3),w(e.locations))},dependencies:[q,G,Q,X,D,T,B,W,z,N,H,U,R,K,A,j,J,V,Y],styles:[".location-image[_ngcontent-%COMP%]{height:120px;object-fit:cover;border-radius:10px}.location-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:10px;height:100%}.location-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;padding-left:5px}.location-details[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{font-size:1rem;margin-bottom:4px;font-weight:700;color:#023e8a}.address[_ngcontent-%COMP%], .locality[_ngcontent-%COMP%], .country[_ngcontent-%COMP%]{font-size:.85rem;margin:1px 0;color:#555}.search-container[_ngcontent-%COMP%]{text-align:center;max-width:800px;margin:2rem auto;padding:1.5rem 2rem;background:#d0e7ff;border-radius:12px;box-shadow:0 4px 8px #0000001a;backdrop-filter:blur(6px);-webkit-backdrop-filter:blur(6px)}.search-container[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: transparent}"]});let l=a;return l})();export{pe as SearchPage};
