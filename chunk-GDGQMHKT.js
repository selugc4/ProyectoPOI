import{a as B}from"./chunk-UYLNLCYZ.js";import{c as n,g as R,i as b,oa as h,pa as g,qa as v}from"./chunk-BWDMBPI3.js";import{g as d}from"./chunk-OLRFWS6T.js";var C=(()=>{let u=class u{constructor(){this.baseUrl="https://twm-a0gahqe6exa7fxh6.westeurope-01.azurewebsites.net/locations/",this.http=b(v),this.authService=b(B)}getAllLocations(){return this.http.get(this.baseUrl)}searchLocations(t){let e=new g;return t.name&&(e=e.set("name",t.name)),t.date&&(e=e.set("date",t.date)),t.region&&(e=e.set("region",t.region)),this.http.get(this.baseUrl,{params:e})}getLocationById(t){return this.http.get(`${this.baseUrl}${t}`)}addReview(t,e){let o=`${this.baseUrl}${t}/reviews`;return this.http.post(o,e)}addReviewLogged(t,e){let o=`${this.baseUrl}${t}/reviews`;return this.http.post(o,e)}deleteReview(t,e){return d(this,null,function*(){let o=yield this.authService.getFirebaseIdToken();if(!o)throw new Error("No se pudo obtener el token de Firebase");let i="https://twm-a0gahqe6exa7fxh6.westeurope-01.azurewebsites.net/login",c=new h({"Content-Type":"application/json"}),p={firebaseToken:o},r=(yield n(this.http.post(i,p,{headers:c}))).token;if(!r)throw new Error("No se recibi\xF3 token personalizado");let a=`${this.baseUrl}${t}/reviews/${e}`,l=new h().set("Authorization",`Bearer ${r}`);return yield n(this.http.delete(a,{headers:l}))})}updateLocation(t,e){return d(this,null,function*(){let o=yield this.authService.getFirebaseIdToken();if(!o)throw new Error("No se pudo obtener el token de Firebase");let i="https://twm-a0gahqe6exa7fxh6.westeurope-01.azurewebsites.net/login",c=new h({"Content-Type":"application/json"}),p={firebaseToken:o},r=(yield n(this.http.post(i,p,{headers:c}))).token;if(!r)throw new Error("No se recibi\xF3 token personalizado");let a=`${this.baseUrl}${e}`,l=r?new h().set("Authorization",`Bearer ${r}`):void 0;return yield n(this.http.put(a,t,{headers:l}))})}deleteLocation(t){return d(this,null,function*(){let e=yield this.authService.getFirebaseIdToken();if(!e)throw new Error("No se pudo obtener el token de Firebase");let o="https://twm-a0gahqe6exa7fxh6.westeurope-01.azurewebsites.net/login",i=new h({"Content-Type":"application/json"}),c={firebaseToken:e},s=(yield n(this.http.post(o,c,{headers:i}))).token;if(!s)throw new Error("No se recibi\xF3 token personalizado");let r=`${this.baseUrl}${t}`,a=s?new h().set("Authorization",`Bearer ${s}`):void 0;return yield n(this.http.delete(r,{headers:a}))})}getApiPOIs(t,e,o){return d(this,null,function*(){let i=yield this.authService.getFirebaseIdToken();if(!i)throw new Error("No se pudo obtener el token de Firebase");let c="https://twm-a0gahqe6exa7fxh6.westeurope-01.azurewebsites.net/login",p=new h({"Content-Type":"application/json"}),s={firebaseToken:i},a=(yield n(this.http.post(c,s,{headers:p}))).token;if(!a)throw new Error("No se recibi\xF3 token personalizado");let l=new g;t&&(l=l.set("name",t)),e!==void 0&&(l=l.set("lat",e.toString())),o!==void 0&&(l=l.set("lng",o.toString()));let F="https://twm-a0gahqe6exa7fxh6.westeurope-01.azurewebsites.net/locationsApi",q=a?new h().set("Authorization",`Bearer ${a}`):void 0;return(yield n(this.http.get(F,{headers:q,params:l}))).map(w=>{var m,k,y,z,x,$,T,U;return{name:w.name,address:((m=w.location)==null?void 0:m.address)||"",locality:((k=w.location)==null?void 0:k.locality)||"",region:((y=w.location)==null?void 0:y.region)||"",country:((z=w.location)==null?void 0:z.country)||"",fsq_id:w.fsq_id,image:"",Otherlat:((x=w.geocodes)==null?void 0:x.main.latitude)||0,Otherlng:(($=w.geocodes)==null?void 0:$.main.longitude)||0,Ownlat:((T=w.geocodes)==null?void 0:T.main.latitude)||0,Ownlng:((U=w.geocodes)==null?void 0:U.main.longitude)||0,reviews:[],createdBy:""}})})}insertMany(t){return d(this,null,function*(){let e=yield this.authService.getFirebaseIdToken();if(!e)throw new Error("No se pudo obtener el token de Firebase");let o="https://twm-a0gahqe6exa7fxh6.westeurope-01.azurewebsites.net/login",i=new h({"Content-Type":"application/json"}),c={firebaseToken:e},s=(yield n(this.http.post(o,c,{headers:i}))).token;if(!s)throw new Error("No se recibi\xF3 token personalizado");let r=`${this.baseUrl}many`,a=s?new h().set("Authorization",`Bearer ${s}`):void 0;return yield n(this.http.post(r,t,{headers:a}))})}insert(t){return d(this,null,function*(){let e=yield this.authService.getFirebaseIdToken();if(!e)throw new Error("No se pudo obtener el token de Firebase");let o="https://twm-a0gahqe6exa7fxh6.westeurope-01.azurewebsites.net/login",i=new h({"Content-Type":"application/json"}),c={firebaseToken:e},s=(yield n(this.http.post(o,c,{headers:i}))).token;if(!s)throw new Error("No se recibi\xF3 token personalizado");let r=`${this.baseUrl}`,a=s?new h().set("Authorization",`Bearer ${s}`):void 0;return yield n(this.http.post(r,t,{headers:a}))})}getRecommendedRoute(t,e){return d(this,null,function*(){let o=new g().set("userId",e).set("city",t),i=yield n(this.http.get("https://twm-a0gahqe6exa7fxh6.westeurope-01.azurewebsites.net/locationsGroq",{params:o}));return n(this.http.post("https://twm-a0gahqe6exa7fxh6.westeurope-01.azurewebsites.net/ruta",{city:t,locations:i}))})}};u.\u0275fac=function(e){return new(e||u)},u.\u0275prov=R({token:u,factory:u.\u0275fac,providedIn:"root"});let f=u;return f})();export{C as a};
